<!-- build time:Thu Dec 17 2020 21:09:18 GMT+0800 (GMT+08:00) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="你好，世界" href="https://github.com/ICAN1999/ICAN1999.github.io.git/rss.xml"><link rel="alternate" type="application/atom+xml" title="你好，世界" href="https://github.com/ICAN1999/ICAN1999.github.io.git/atom.xml"><link rel="alternate" type="application/json" title="你好，世界" href="https://github.com/ICAN1999/ICAN1999.github.io.git/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="爬虫"><link rel="canonical" href="https://github.com/ICAN1999/ICAN1999.github.io.git/python/crawler-case/%E7%88%AC%E5%8F%96%E8%B1%86%E7%93%A3TOP250/"><title>爬取豆瓣TOP250 - 爬虫案例 - Python | Hello World = 你好，世界</title><meta name="generator" content="Hexo 5.2.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">爬取豆瓣TOP250</h1><div class="meta"><span class="item" title="创建时间：2020-12-14 21:00:52"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2020-12-14T21:00:52+08:00">2020-12-14</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>14k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>13 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Hello World</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://tva1.sinaimg.cn/large/6833939bly1giph4lm9i7j20zk0m84qp.jpg"></li><li class="item" data-background-image="https://tva1.sinaimg.cn/large/6833939bly1gipey0a334j20zk0m8qpt.jpg"></li><li class="item" data-background-image="https://tva1.sinaimg.cn/large/6833939bly1gipex2cdtbj20zk0m8x6p.jpg"></li><li class="item" data-background-image="https://tva1.sinaimg.cn/large/6833939bly1gipeyhsblkj20zk0m81kx.jpg"></li><li class="item" data-background-image="https://tva1.sinaimg.cn/large/6833939bly1gipet8c1a2j20zk0m8kct.jpg"></li><li class="item" data-background-image="https://tva1.sinaimg.cn/large/6833939bly1gipetv6p75j20zk0m8x6p.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/python/" itemprop="item" rel="index" title="分类于 Python"><span itemprop="name">Python</span></a><meta itemprop="position" content="1"></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/python/crawler-case/" itemprop="item" rel="index" title="分类于 爬虫案例"><span itemprop="name">爬虫案例</span></a><meta itemprop="position" content="2"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://github.com/ICAN1999/ICAN1999.github.io.git/python/crawler-case/%E7%88%AC%E5%8F%96%E8%B1%86%E7%93%A3TOP250/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/%E6%9C%AA%E6%9D%A5.jpg"><meta itemprop="name" content="阿冬"><meta itemprop="description" content=", 想进大厂的小白"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="你好，世界"></span><div class="body md" itemprop="articleBody"><p>看完小甲鱼的爬取豆瓣 TOP250 的视频后，自己对代码进行了改写。</p><p><a id="more"></a></p><h1 id="准备工作"><a class="anchor" href="#准备工作">#</a> 准备工作</h1><h2 id="观察"><a class="anchor" href="#观察">#</a> 观察</h2><p>要分自己观察爬取每个网页的信息，以免在后面的操作出现失误，比如：有的电影没有写上主演甚至主演就是一个省略号等一些情况（主要它的信息没有填写完整），这样更有利于我们编写代码。进入这个链接<span class="exturl" data-url="aHR0cHM6Ly9tb3ZpZS5kb3ViYW4uY29tL3RvcDI1MA=="> https://movie.douban.com/top250</span>，然后可以发现每一页总共有 25 部电影，总共有十页，然后我们进入第二页时，发现链接变为<span class="exturl" data-url="aHR0cHM6Ly9tb3ZpZS5kb3ViYW4uY29tP3N0YXJ0PTI1JmFtcDtmaWx0ZXI9"> https://movie.douban.com?start=25&amp;filter=</span>，进入到下一个页面时 start 的值就增加 25 直到 225，第一页 start 的值为 0。</p><h2 id="尝试获取页面源代码"><a class="anchor" href="#尝试获取页面源代码">#</a> 尝试获取页面源代码</h2><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>url <span class="token operator">=</span> <span class="token string">"https://movie.douban.com/top250"</span></pre></td></tr><tr><td data-num="2"></td><td><pre>r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre>r<span class="token punctuation">.</span>encoding <span class="token operator">=</span> r<span class="token punctuation">.</span>apparent_encoding</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>status_code<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre>soup <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>r<span class="token punctuation">.</span>text<span class="token punctuation">,</span> <span class="token string">"html.parser"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>soup<span class="token punctuation">.</span>prettify<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>结果却只得到 http 的状态码为 418，这种情况通常百度搜索，一般来说状态码为 200 时，才请求成功。肯定是服务器拒绝了爬虫的请求，一般来说有一下几个方法：</p><h2 id="请求标头"><a class="anchor" href="#请求标头">#</a> 请求标头</h2><p>设置 get 或者 request 方法（这个方法第一个参数是 method，表示 7 种请求的方式，第二个参数才是 url）里的 headers 参数。这个参数的类型为字典，键为 &quot;User-Agent&quot;，值为当前网站提供你所用浏览器类型等信息的标识。&lt;br&gt;</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>url <span class="token operator">=</span> <span class="token string">"https://movie.douban.com/top250"</span></pre></td></tr><tr><td data-num="2"></td><td><pre>r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>request<span class="token punctuation">.</span>headers<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">&#123;</span><span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'python-requests/2.24.0'</span><span class="token punctuation">,</span> <span class="token string">'Accept-Encoding'</span><span class="token punctuation">:</span> <span class="token string">'gzip, deflate'</span><span class="token punctuation">,</span> <span class="token string">'Accept'</span><span class="token punctuation">:</span> <span class="token string">'*/*'</span><span class="token punctuation">,</span> <span class="token string">'Connection'</span><span class="token punctuation">:</span> <span class="token string">'keep-alive'</span><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>这是没有设置这个参数的情况，网站通过 &quot;User-Agent&quot; 这个标识一下就认出这是爬虫程序并拒绝访问。当我们设置这个参数后情况就不一样了。</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>url <span class="token operator">=</span> <span class="token string">"https://movie.douban.com/top250"</span></pre></td></tr><tr><td data-num="2"></td><td><pre>hd <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'User-Agent'</span><span class="token punctuation">:</span><span class="token string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.121 Safari/537.36 Edg/85.0.564.63'</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>hd<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>request<span class="token punctuation">.</span>headers<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">&#123;</span><span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.121 Safari/537.36 Edg/85.0.564.63'</span><span class="token punctuation">,</span> <span class="token string">'Accept-Encoding'</span><span class="token punctuation">:</span> <span class="token string">'gzip, deflate'</span><span class="token punctuation">,</span> <span class="token string">'Accept'</span><span class="token punctuation">:</span> <span class="token string">'*/*'</span><span class="token punctuation">,</span> <span class="token string">'Connection'</span><span class="token punctuation">:</span> <span class="token string">'keep-alive'</span><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>有了这个标识之后，网站向我们响应（也就是 response 对象）得到 request 请求里的 headers 就能看到 &quot;User-Agent&quot;, 这样爬虫就可以隐藏自己的身份伪装成浏览器，让网站以为是人点击访问。</p><h2 id="代理-ip"><a class="anchor" href="#代理-ip">#</a> 代理 ip</h2><p>设置 proxies 使用代理服务器。使用爬虫爬取一个网站时，通常会频繁的访问该网站，网站会检测某一段时间某个 ip 的访问次数，如果访问次数过多，它会禁止你的访问。所有我们可以设置一些代理服务器来帮我们工作，每隔一段时间切换一个 ip，这样就不会出现禁止访问的现象。以上这两种方法我们可以使用 random 库的 choice 方法随机选择 'User-Agent'、'http' 或者 'https'。</p><h2 id="cookie-认证"><a class="anchor" href="#cookie-认证">#</a> cookie 认证</h2><p>设置上述两个方法里的 cookies 参数，对应 Request 里的 cookie，这个可以检查网页对应链接的 Network 获得 Cookie。爬虫程序有了认证 cookie，服务器就会将它重定向到初始请求的资源，以免爬虫被引导到登录界面。如果多次之后还是失败的话，那就得考虑其他反爬虫机制的方法了。</p><h2 id="如何得到-10-这个数字"><a class="anchor" href="#如何得到-10-这个数字">#</a> 如何得到 10 这个数字</h2><p>找到页面下方 10 这个数字，鼠标左边点击检查，然后浏览器就会出现网站页面的源代码，并且还会自动跳转到 10 这个标签 &lt;a href=&quot;?start=225&amp;filter=&quot;&gt;10&lt;/a&gt;，这 1~10 都是 &lt; a &gt; 超链接标签。</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>url <span class="token operator">=</span> <span class="token string">"https://movie.douban.com/top250"</span></pre></td></tr><tr><td data-num="2"></td><td><pre>hd <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'User-Agent'</span><span class="token punctuation">:</span><span class="token string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.121 Safari/537.36 Edg/85.0.564.63'</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>hd<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre>r<span class="token punctuation">.</span>encoding <span class="token operator">=</span> r<span class="token punctuation">.</span>apparent_encoding</pre></td></tr><tr><td data-num="5"></td><td><pre>soup <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>r<span class="token punctuation">.</span>text<span class="token punctuation">,</span> <span class="token string">"html.parser"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>depth <span class="token operator">=</span> soup<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">,</span> href<span class="token operator">=</span><span class="token string">"?start=225&amp;filter="</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>depth<span class="token punctuation">.</span>text<span class="token punctuation">)</span></pre></td></tr></table></figure><p>结果为 10，但是类型为 str，这里要做一个强制类型转换。<br>还有另一种方法，比较麻烦又愚蠢而且容易懵，但我还是有个小细节想强调一下。可以看出 &lt;a&gt; 和 &lt; span &gt; 这两个标签都是 &lt; div &gt; 中，而它们又是同级标签，那么我们先找到 &lt; a href=&quot;?start=225&amp;filter=&quot;&gt;10&lt;/a &gt; 下的 &lt; span &gt; 标签，然后再平行遍历到 &lt; a href=&quot;?start=225&amp;filter=&quot;&gt;10&lt;/a&gt;。</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>url <span class="token operator">=</span> <span class="token string">"https://movie.douban.com/top250"</span></pre></td></tr><tr><td data-num="2"></td><td><pre>hd <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'User-Agent'</span><span class="token punctuation">:</span><span class="token string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.121 Safari/537.36 Edg/85.0.564.63'</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>hd<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre>r<span class="token punctuation">.</span>encoding <span class="token operator">=</span> r<span class="token punctuation">.</span>apparent_encoding</pre></td></tr><tr><td data-num="5"></td><td><pre>soup <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>r<span class="token punctuation">.</span>text<span class="token punctuation">,</span> <span class="token string">"html.parser"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>depth <span class="token operator">=</span> soup<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'span'</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">'next'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>previous_sibling</pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>depth<span class="token punctuation">)</span></pre></td></tr></table></figure><p>结果却什么也没有，但是好像输出的空白比以往多了一行，原来是标签之间多了一个换行符，现在还真看不出来。</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token operator">>></span><span class="token operator">></span>depth <span class="token operator">=</span> soup<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'span'</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">'next'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token operator">>></span><span class="token operator">></span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>depth<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">[</span><span class="token string">'\n'</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>link href<span class="token operator">=</span><span class="token string">"?start=25&amp;amp;filter="</span> rel<span class="token operator">=</span><span class="token string">"next"</span><span class="token operator">></span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"?start=25&amp;amp;filter="</span><span class="token operator">></span>后页<span class="token operator">&amp;</span>gt<span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">></span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">/</span>link<span class="token operator">></span><span class="token punctuation">]</span></pre></td></tr></table></figure><p>那再加一个 previous_sibling 就可以得到 10，这里同样要类型转换。</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>depth <span class="token operator">=</span> soup<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'span'</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">'next'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>previous_sibling<span class="token punctuation">.</span>previous_sibling</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>depth<span class="token punctuation">.</span>text<span class="token punctuation">)</span></pre></td></tr></table></figure><h1 id="爬取网页"><a class="anchor" href="#爬取网页">#</a> 爬取网页</h1><p>有了以上的准备我们就可以爬取网页的源代码了，废话不多说，直接上代码解释。</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 爬取网页代码</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">def</span> <span class="token function">get_html</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token comment"># 使用代理</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    iplist <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"121.232.148.225"</span><span class="token punctuation">,</span> <span class="token string">"123.101.207.185"</span><span class="token punctuation">,</span> <span class="token string">"69.195.157.162"</span><span class="token punctuation">,</span> <span class="token string">"175.44.109.246"</span><span class="token punctuation">,</span> <span class="token string">"175.42.128.246"</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token comment"># random 库的 choice 方法随机选择 ip</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    proxies <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"http"</span><span class="token punctuation">:</span> random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>iplist<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    headers <span class="token operator">=</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>        <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> 'Mozilla<span class="token operator">/</span><span class="token number">5.0</span> <span class="token punctuation">(</span>Windows NT <span class="token number">10.0</span><span class="token punctuation">;</span> Win64<span class="token punctuation">;</span> x64<span class="token punctuation">)</span> AppleWebKit<span class="token operator">/</span><span class="token number">537.36</span> \</pre></td></tr><tr><td data-num="9"></td><td><pre>        <span class="token punctuation">(</span>KABUL<span class="token punctuation">,</span> like Gecko<span class="token punctuation">)</span> Chrome<span class="token operator">/</span><span class="token number">85.0</span><span class="token number">.4183</span><span class="token number">.121</span> Safari<span class="token operator">/</span><span class="token number">537.36</span> Edg<span class="token operator">/</span><span class="token number">85.0</span><span class="token number">.564</span><span class="token number">.63</span>'<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        <span class="token string">'cookie'</span><span class="token punctuation">:</span> <span class="token string">'bid=mDUxIx660Vg; douban-fav-remind=1; ll="118300"; '</span></pre></td></tr><tr><td data-num="11"></td><td><pre>                  <span class="token string">'_vwo_uuid_v2=D0D095AA577CA9982D96BF53E5B82D902|19baada46789b48f67201d5ad830a0f6; '</span></pre></td></tr><tr><td data-num="12"></td><td><pre>                  <span class="token string">'__yadk_uid=gAC153pUujwGBubBMhpUqg8osqjO7FfD; '</span></pre></td></tr><tr><td data-num="13"></td><td><pre>                  <span class="token string">'__utmz=30149280.1601027331.15.8.utmcsr=accounts.douban.com|utmccn=('</span></pre></td></tr><tr><td data-num="14"></td><td><pre>                  <span class="token string">'referral)|utmcmd=referral|utmcct=/passport/login; '</span></pre></td></tr><tr><td data-num="15"></td><td><pre>                  <span class="token string">'__utmz=223695111.1601028074.12.5.utmcsr=accounts.douban.com|utmccn=('</span></pre></td></tr><tr><td data-num="16"></td><td><pre>                  <span class="token string">'referral)|utmcmd=referral|utmcct=/passport/login; push_noty_num=0; push_doumail_num=0; ct=y; '</span></pre></td></tr><tr><td data-num="17"></td><td><pre>                  <span class="token string">'ap_v=0,6.0; __utmc=30149280; __utmc=223695111; '</span></pre></td></tr><tr><td data-num="18"></td><td><pre>                  <span class="token string">'__utma=30149280.846971982.1594690041.1601194295.1601199438.18; '</span></pre></td></tr><tr><td data-num="19"></td><td><pre>                  <span class="token string">'__utma=223695111.2022617817.1595329698.1601194295.1601199438.15; __utmb=223695111.0.10.1601199438; '</span></pre></td></tr><tr><td data-num="20"></td><td><pre>                  <span class="token string">'_pk_ses.100001.4cf6=*; _pk_ref.100001.4cf6=%5B%22%22%2C%22%22%2C1601199438%2C%22https%3A%2F'</span></pre></td></tr><tr><td data-num="21"></td><td><pre>                  <span class="token string">'%2Faccounts.douban.com%2Fpassport%2Flogin%3Fredir%3Dhttps%253A%252F%252Fmovie.douban.com'</span></pre></td></tr><tr><td data-num="22"></td><td><pre>                  <span class="token string">'%252Ftop250%22%5D; dbcl2="216449506:1anURmdR9nE"; ck=LxNQ; __utmt=1; __utmv=30149280.21644; '</span></pre></td></tr><tr><td data-num="23"></td><td><pre>                  <span class="token string">'douban-profile-remind=1; '</span></pre></td></tr><tr><td data-num="24"></td><td><pre>                  <span class="token string">'__gads=ID=c502f7a27a33facd-22f60957b9c300e3:T=1601201244:S=ALNI_MbN9wSYWbg2k5f3fWucwuXpORbGNw; '</span></pre></td></tr><tr><td data-num="25"></td><td><pre>                  <span class="token string">'__utmb=30149280.20.10.1601199438; '</span></pre></td></tr><tr><td data-num="26"></td><td><pre>                  <span class="token string">'_pk_id.100001.4cf6=d35078454df4f375.1595329083.15.1601201286.1601197192.'</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>    res <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">,</span> proxies<span class="token operator">=</span>proxies<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="28"></td><td><pre>    <span class="token keyword">return</span> res</pre></td></tr></table></figure><p>定义一个获取网页源代码的函数，返回 Response 对象。这里有两种方法直接设置 cookie，一是添加到 headers，二是设置 cookies 参数。设置 timeout，timeout=([连接超时时间], [读取超时时间])，这里我们设置连接超时时间以免爬虫卡死又没有报错。</p><h1 id="解析网页"><a class="anchor" href="#解析网页">#</a> 解析网页</h1><p>解析网页是爬虫程序中最重要的一部分。我们已经得到了链接为<span class="exturl" data-url="aHR0cHM6Ly9tb3ZpZS5kb3ViYW4uY29tL3RvcDI1MD9zdGFydD0w"> https://movie.douban.com/top250?start=0</span> 下的网页源代码，然后我们就要解析 HTML 代码。使用 BeautifulSoup 库将它熬制成一碗美味汤，使用自带的 html.parser 解析器，对自定义的 get_html (url) 函数返回的 Response 对象的 text 属性进行解析就可以得到源代码了。</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>soup <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>res<span class="token punctuation">.</span>text<span class="token punctuation">,</span> <span class="token string">'html.parser'</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>剩下来的 9 页方法上基本差不多，注意一下个别信息缺失的电影，之后弄个循环就可以了。每部电影基本上有名称、评分、影评人数、导演、主演、上映时间、来自哪个国家和是什么类型的电影，还有对电影的描述。总共有这么多内容，接下就要用爬虫把它们一个个提取出来。定义一个函数，将提取出来的所有信息全部保存到一个列表，返回值为列表。</p><p>先上图，接下来我们要爬取信息大部分都在这个标签中。</p><p><img data-src="/images/1.jpg" alt="alt"></p><h2 id="电影名"><a class="anchor" href="#电影名">#</a> 电影名</h2><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>movies <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment"># 找到 div 标签</span></pre></td></tr><tr><td data-num="3"></td><td><pre>targets <span class="token operator">=</span> soup<span class="token punctuation">.</span>find_all<span class="token punctuation">(</span><span class="token string">"div"</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">"hd"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">for</span> each <span class="token keyword">in</span> targets<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">try</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="6"></td><td><pre>        <span class="token comment"># div 标签下的 a 标签的下 span 标签的属性 next 才是电影名称，这</span></pre></td></tr><tr><td data-num="7"></td><td><pre>        三个标签是包含关系</pre></td></tr><tr><td data-num="8"></td><td><pre>        movies<span class="token punctuation">.</span>append<span class="token punctuation">(</span>each<span class="token punctuation">.</span>a<span class="token punctuation">.</span>span<span class="token punctuation">.</span>text<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        <span class="token comment"># 为确保程序正常运行，这里添加一个异常处理。</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">finally</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        <span class="token keyword">continue</span></pre></td></tr></table></figure><p>鼠标箭头放在电影名称上，然后左键就可以看到对应的标签，这个标签刚好是 &lt;div class=&quot;hd&quot;&gt; 标签中的 &lt; a href=&quot;<span class="exturl" data-url="aHR0cHM6Ly9tb3ZpZS5kb3ViYW4uY29tL3N1YmplY3QvMTI5MjA1Mi8=">https://movie.douban.com/subject/1292052/</span>&quot;class &gt; 的第一个标签，因此我们先找到 &lt;div class=&quot;hd&quot;&gt; 再找到 &lt; span class=&quot;title&quot;&gt; 肖申克的救赎 &lt;/span &gt; 这个标签，最后提取内容。使用 find_all 方法查找所有符合这个要求的标签并返回一个集合，然后将集合中的每个元素添加到列表中。</p><h2 id="评分"><a class="anchor" href="#评分">#</a> 评分</h2><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>ranks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="2"></td><td><pre>targets <span class="token operator">=</span> soup<span class="token punctuation">.</span>find_all<span class="token punctuation">(</span><span class="token string">"span"</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">"rating_num"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">for</span> each <span class="token keyword">in</span> targets<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">try</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre>        ranks<span class="token punctuation">.</span>append<span class="token punctuation">(</span>each<span class="token punctuation">.</span>text<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">finally</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="7"></td><td><pre>        <span class="token keyword">continue</span></pre></td></tr></table></figure><p>评分跟电影名都是类似这样的方法就可以得到。</p><h2 id="导演"><a class="anchor" href="#导演">#</a> 导演</h2><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>director <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="2"></td><td><pre>targets <span class="token operator">=</span> soup<span class="token punctuation">.</span>find_all<span class="token punctuation">(</span><span class="token string">"div"</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">"bd"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">for</span> each <span class="token keyword">in</span> targets<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">try</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre>        <span class="token comment"># split 方法分割字符串并返回分割后字符串的列表</span></pre></td></tr><tr><td data-num="6"></td><td><pre>        <span class="token comment"># lstrip 去除左侧指定字符串</span></pre></td></tr><tr><td data-num="7"></td><td><pre>        director<span class="token punctuation">.</span>append<span class="token punctuation">(</span>each<span class="token punctuation">.</span>p<span class="token punctuation">.</span>text<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\xa0\xa0\xa0'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>lstrip<span class="token punctuation">(</span><span class="token string">'导演: '</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">finally</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="9"></td><td><pre>         <span class="token keyword">continue</span></pre></td></tr></table></figure><p>老方法找到导演的内容所在的标签，它在 &lt;div class=&quot;bd&quot;&gt; 里的 &lt; p class &gt; 中，找到之后发现我们想要的信息都在这里面。接下来就要将 &lt; p &gt; 中的内容提取出来，内容为字符串类型，这里用 split 就整个字符串进行分割返回一个列表，然后选择正确的字符串并且用 strip 去掉无关的内容。</p><h2 id="主演"><a class="anchor" href="#主演">#</a> 主演</h2><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>leading_actor <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="2"></td><td><pre>targets <span class="token operator">=</span> soup<span class="token punctuation">.</span>find_all<span class="token punctuation">(</span><span class="token string">"div"</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">"bd"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">for</span> each <span class="token keyword">in</span> targets<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">try</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre>        leading_actor<span class="token punctuation">.</span>append<span class="token punctuation">(</span>each<span class="token punctuation">.</span>p<span class="token punctuation">.</span>text<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\xa0\xa0\xa0'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'主演:'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">finally</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="7"></td><td><pre>        <span class="token keyword">continue</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">if</span> movies<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"肖申克的救赎"</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    leading_actor<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">,</span> <span class="token string">"无"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">if</span> movies<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"大闹天宫"</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    leading_actor<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">"无"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    leading_actor<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">"无"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">if</span> movies<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"美国往事"</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    leading_actor<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">"无"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">if</span> movies<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"阳光姐妹淘"</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    leading_actor<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">23</span><span class="token punctuation">,</span> <span class="token string">"无"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token keyword">if</span> movies<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"七武士"</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    leading_actor<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">"无"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token keyword">if</span> movies<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"模仿游戏"</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    leading_actor<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">"无"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    leading_actor<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token string">"无"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token keyword">if</span> movies<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"罗生门"</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    leading_actor<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">"无"</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>总共有 10 页，有些页的电影会缺少主演，如果这里没有 try、finally 异常处理的话，程序将会在这里报错：IndexError: list index out of range，意思索引超出范围，因为在 append () 的这个括号里有不符合这个分割的字符串，分割之后并没有这个列表。</p><p><img data-src="/images/2.jpg" alt="我这里"></p><p>就比如第一页最后一个电影《触不可及》，不能以 &quot;主演:&quot; 分割，返回不了一个列表也就没有 split (&quot;主演:&quot;)[1] 这个索引了。之后在每次循环找到对应的缺失页后就往列表里插入缺失的信息，保证 10 次循环的每次 leading_actor 的长度都为 25，因为每页总共 25 电影。</p><h2 id="评价人数"><a class="anchor" href="#评价人数">#</a> 评价人数</h2><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>people <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="2"></td><td><pre>targets <span class="token operator">=</span> soup<span class="token punctuation">.</span>find_all<span class="token punctuation">(</span><span class="token string">"div"</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">"star"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">for</span> each <span class="token keyword">in</span> targets<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">try</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre>        people<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>each<span class="token punctuation">.</span>contents<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">.</span>rstrip<span class="token punctuation">(</span><span class="token string">"人评价"</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">finally</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="7"></td><td><pre>        <span class="token keyword">continue</span></pre></td></tr></table></figure><p>将 &lt;div&gt; 标签下的的所有儿子节点（contents）索引为 7 的 text 转化为 str 并去掉 &quot;人评价&quot;，最后存入列表。</p><h2 id="电影描述"><a class="anchor" href="#电影描述">#</a> 电影描述</h2><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 电影描述，最后两页分别有两篇电影没有描述</span></pre></td></tr><tr><td data-num="2"></td><td><pre>sentence <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="3"></td><td><pre>targets <span class="token operator">=</span> soup<span class="token punctuation">.</span>find_all<span class="token punctuation">(</span><span class="token string">"span"</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">"inq"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">for</span> each <span class="token keyword">in</span> targets<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">try</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="6"></td><td><pre>        sentence<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>each<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">finally</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="8"></td><td><pre>        <span class="token keyword">continue</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">if</span> sentence<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"天使保护事件始末。"</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    sentence<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token string">"无"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    sentence<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">,</span> <span class="token string">"无"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">if</span> sentence<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"生病的E.T.皮肤的颜色就像柿子饼。"</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    sentence<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">"无"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    sentence<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">22</span><span class="token punctuation">,</span> <span class="token string">"无"</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>以缺失页的最后一个电影描述为标记，在列表中插入 “无”，代表该电影没有写上描述，保证每次循环 sentence 的长度为 25。</p><h2 id="上映时间"><a class="anchor" href="#上映时间">#</a> 上映时间</h2><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>year <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="2"></td><td><pre>targets <span class="token operator">=</span> soup<span class="token punctuation">.</span>find_all<span class="token punctuation">(</span><span class="token string">"div"</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">"bd"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">for</span> each <span class="token keyword">in</span> targets<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="4"></td><td><pre>     <span class="token keyword">try</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre>        year<span class="token punctuation">.</span>append<span class="token punctuation">(</span>each<span class="token punctuation">.</span>p<span class="token punctuation">.</span>text<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\xa0'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">"(中国大陆)"</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">finally</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="7"></td><td><pre>        <span class="token keyword">continue</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">if</span> movies<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"大闹天宫"</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        year<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"1961 / 1964 / 1978 / 2004"</span></pre></td></tr></table></figure><p>利用这个异常处理去掉《天书奇谭》年份里的字符串 &quot;中国大陆&quot;。还有一部电影《大闹天宫》的上映年份分别为 1961、1964、1978、2004 这四年，只需修改该网页下第一个 year [0] 的值就行。</p><h2 id="国家"><a class="anchor" href="#国家">#</a> 国家</h2><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>country <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="2"></td><td><pre>targets <span class="token operator">=</span> soup<span class="token punctuation">.</span>find_all<span class="token punctuation">(</span><span class="token string">"div"</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">"bd"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">for</span> each <span class="token keyword">in</span> targets<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">try</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre>        country<span class="token punctuation">.</span>append<span class="token punctuation">(</span>each<span class="token punctuation">.</span>p<span class="token punctuation">.</span>text<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\xa0'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">finally</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="7"></td><td><pre>        <span class="token keyword">continue</span></pre></td></tr></table></figure><h2 id="类型"><a class="anchor" href="#类型">#</a> 类型</h2><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>kinds <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="2"></td><td><pre>targets <span class="token operator">=</span> soup<span class="token punctuation">.</span>find_all<span class="token punctuation">(</span><span class="token string">"div"</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">"bd"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">for</span> each <span class="token keyword">in</span> targets<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">try</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre>        kinds<span class="token punctuation">.</span>append<span class="token punctuation">(</span>each<span class="token punctuation">.</span>p<span class="token punctuation">.</span>text<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\xa0'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">finally</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="7"></td><td><pre>        <span class="token keyword">continue</span></pre></td></tr></table></figure><p>这两个跟之前的是同一个道理。</p><h2 id="整合数据"><a class="anchor" href="#整合数据">#</a> 整合数据</h2><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="2"></td><td><pre>length <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>movies<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>length<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    result<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span>movies<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> ranks<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> director<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> leading_actor<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>people<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> sentence<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> year<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> country<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> kinds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">return</span> result</pre></td></tr></table></figure><p>length 的值为 25，有的电影信息缺失了，也是这些储存电影信息的列表不为 25，在这里将会报 IndexError，所以得确保这些储存信息的列表每次循环之后的长度都为 25，利用循环将每部电影的信息全都保存到 result 里，并作为函数返回值返回。</p><h1 id="保存数据"><a class="anchor" href="#保存数据">#</a> 保存数据</h1><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">def</span> <span class="token function">save_to_excel</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token comment"># 实例化一个对象，相当于创建一个 Excel 文档</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    wb <span class="token operator">=</span> Workbook<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token comment"># 激活 Sheet</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    ws <span class="token operator">=</span> wb<span class="token punctuation">.</span>active</pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token comment"># 设置标题</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    ws<span class="token punctuation">[</span><span class="token string">"A1"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"名称"</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    ws<span class="token punctuation">[</span><span class="token string">"B1"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"评分"</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    ws<span class="token punctuation">[</span><span class="token string">"c1"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"导演"</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    ws<span class="token punctuation">[</span><span class="token string">'d1'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"主演"</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    ws<span class="token punctuation">[</span><span class="token string">"e1"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"评价人数"</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    ws<span class="token punctuation">[</span><span class="token string">"f1"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"电影描述"</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    ws<span class="token punctuation">[</span><span class="token string">"g1"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"年份"</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    ws<span class="token punctuation">[</span><span class="token string">"h1"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"国家"</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    ws<span class="token punctuation">[</span><span class="token string">"i1"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"类型"</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token comment"># 信息添加 ws 中</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">for</span> each <span class="token keyword">in</span> result<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        ws<span class="token punctuation">.</span>append<span class="token punctuation">(</span>each<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token comment"># 保存文件</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    wb<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">"豆瓣电影TOP250.xlsx"</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>这里用到 python 的第三方模块 openpyxl，通过 pip 命令安装。</p><h1 id="主函数"><a class="anchor" href="#主函数">#</a> 主函数</h1><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    host <span class="token operator">=</span> <span class="token string">"https://movie.douban.com/top250"</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    res <span class="token operator">=</span> get_html<span class="token punctuation">(</span>host<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    depth <span class="token operator">=</span> find_pages<span class="token punctuation">(</span>res<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>depth<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="7"></td><td><pre>        url <span class="token operator">=</span> host <span class="token operator">+</span> <span class="token string">'/?start='</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token number">25</span> <span class="token operator">*</span> i<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>        res <span class="token operator">=</span> get_html<span class="token punctuation">(</span>url<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        result<span class="token punctuation">.</span>extend<span class="token punctuation">(</span>parser_html<span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    save_to_excel<span class="token punctuation">(</span>result<span class="token punctuation">)</span></pre></td></tr></table></figure><p>利用 find_pages (res) 获得网页页数，循环 depth 次，每次访问一个链接并获取内容，然后添加到 result 中，最后保存为 excel 格式的文件。</p><h1 id="程序代码"><a class="anchor" href="#程序代码">#</a> 程序代码</h1><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> requests</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> bs4 <span class="token keyword">import</span> BeautifulSoup</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span> random</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">from</span> openpyxl <span class="token keyword">import</span> Workbook</pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">def</span> <span class="token function">get_html</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token comment"># 使用代理</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    iplist <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"121.232.148.225"</span><span class="token punctuation">,</span> <span class="token string">"123.101.207.185"</span><span class="token punctuation">,</span> <span class="token string">"69.195.157.162"</span><span class="token punctuation">,</span> <span class="token string">"175.44.109.246"</span><span class="token punctuation">,</span> <span class="token string">"175.42.128.246"</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    proxies <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"http"</span><span class="token punctuation">:</span> random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>iplist<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    headers <span class="token operator">=</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> 'Mozilla<span class="token operator">/</span><span class="token number">5.0</span> <span class="token punctuation">(</span>Windows NT <span class="token number">10.0</span><span class="token punctuation">;</span> Win64<span class="token punctuation">;</span> x64<span class="token punctuation">)</span> AppleWebKit<span class="token operator">/</span><span class="token number">537.36</span> \</pre></td></tr><tr><td data-num="13"></td><td><pre>        <span class="token punctuation">(</span>KABUL<span class="token punctuation">,</span> like Gecko<span class="token punctuation">)</span> Chrome<span class="token operator">/</span><span class="token number">85.0</span><span class="token number">.4183</span><span class="token number">.121</span> Safari<span class="token operator">/</span><span class="token number">537.36</span> Edg<span class="token operator">/</span><span class="token number">85.0</span><span class="token number">.564</span><span class="token number">.63</span>'<span class="token punctuation">,</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token string">'cookie'</span><span class="token punctuation">:</span> <span class="token string">'bid=mDUxIx660Vg; douban-fav-remind=1; ll="118300"; '</span></pre></td></tr><tr><td data-num="15"></td><td><pre>                  <span class="token string">'_vwo_uuid_v2=D0D095AA577CA9982D96BF53E5B82D902|19baada46789b48f67201d5ad830a0f6; '</span></pre></td></tr><tr><td data-num="16"></td><td><pre>                  <span class="token string">'__yadk_uid=gAC153pUujwGBubBMhpUqg8osqjO7FfD; '</span></pre></td></tr><tr><td data-num="17"></td><td><pre>                  <span class="token string">'__utmz=30149280.1601027331.15.8.utmcsr=accounts.douban.com|utmccn=('</span></pre></td></tr><tr><td data-num="18"></td><td><pre>                  <span class="token string">'referral)|utmcmd=referral|utmcct=/passport/login; '</span></pre></td></tr><tr><td data-num="19"></td><td><pre>                  <span class="token string">'__utmz=223695111.1601028074.12.5.utmcsr=accounts.douban.com|utmccn=('</span></pre></td></tr><tr><td data-num="20"></td><td><pre>                  <span class="token string">'referral)|utmcmd=referral|utmcct=/passport/login; push_noty_num=0; push_doumail_num=0; ct=y; '</span></pre></td></tr><tr><td data-num="21"></td><td><pre>                  <span class="token string">'ap_v=0,6.0; __utmc=30149280; __utmc=223695111; '</span></pre></td></tr><tr><td data-num="22"></td><td><pre>                  <span class="token string">'__utma=30149280.846971982.1594690041.1601194295.1601199438.18; '</span></pre></td></tr><tr><td data-num="23"></td><td><pre>                  <span class="token string">'__utma=223695111.2022617817.1595329698.1601194295.1601199438.15; __utmb=223695111.0.10.1601199438; '</span></pre></td></tr><tr><td data-num="24"></td><td><pre>                  <span class="token string">'_pk_ses.100001.4cf6=*; _pk_ref.100001.4cf6=%5B%22%22%2C%22%22%2C1601199438%2C%22https%3A%2F'</span></pre></td></tr><tr><td data-num="25"></td><td><pre>                  <span class="token string">'%2Faccounts.douban.com%2Fpassport%2Flogin%3Fredir%3Dhttps%253A%252F%252Fmovie.douban.com'</span></pre></td></tr><tr><td data-num="26"></td><td><pre>                  <span class="token string">'%252Ftop250%22%5D; dbcl2="216449506:1anURmdR9nE"; ck=LxNQ; __utmt=1; __utmv=30149280.21644; '</span></pre></td></tr><tr><td data-num="27"></td><td><pre>                  <span class="token string">'douban-profile-remind=1; '</span></pre></td></tr><tr><td data-num="28"></td><td><pre>                  <span class="token string">'__gads=ID=c502f7a27a33facd-22f60957b9c300e3:T=1601201244:S=ALNI_MbN9wSYWbg2k5f3fWucwuXpORbGNw; '</span></pre></td></tr><tr><td data-num="29"></td><td><pre>                  <span class="token string">'__utmb=30149280.20.10.1601199438; '</span></pre></td></tr><tr><td data-num="30"></td><td><pre>                  <span class="token string">'_pk_id.100001.4cf6=d35078454df4f375.1595329083.15.1601201286.1601197192.'</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    res <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">,</span> proxies<span class="token operator">=</span>proxies<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="32"></td><td><pre>    <span class="token comment"># res = requests.get(url, headers=headers)</span></pre></td></tr><tr><td data-num="33"></td><td><pre>    <span class="token keyword">return</span> res</pre></td></tr><tr><td data-num="34"></td><td><pre></pre></td></tr><tr><td data-num="35"></td><td><pre></pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token keyword">def</span> <span class="token function">parser_html</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="37"></td><td><pre>    soup <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>res<span class="token punctuation">.</span>text<span class="token punctuation">,</span> <span class="token string">'html.parser'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="38"></td><td><pre></pre></td></tr><tr><td data-num="39"></td><td><pre>    <span class="token comment"># 电影名</span></pre></td></tr><tr><td data-num="40"></td><td><pre>    movies <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="41"></td><td><pre>    targets <span class="token operator">=</span> soup<span class="token punctuation">.</span>find_all<span class="token punctuation">(</span><span class="token string">"div"</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">"hd"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="42"></td><td><pre>    <span class="token keyword">for</span> each <span class="token keyword">in</span> targets<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="43"></td><td><pre>        <span class="token keyword">try</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="44"></td><td><pre>            movies<span class="token punctuation">.</span>append<span class="token punctuation">(</span>each<span class="token punctuation">.</span>a<span class="token punctuation">.</span>span<span class="token punctuation">.</span>text<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="45"></td><td><pre>        <span class="token keyword">finally</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="46"></td><td><pre>            <span class="token keyword">continue</span></pre></td></tr><tr><td data-num="47"></td><td><pre></pre></td></tr><tr><td data-num="48"></td><td><pre>    <span class="token comment"># 评分</span></pre></td></tr><tr><td data-num="49"></td><td><pre>    ranks <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="50"></td><td><pre>    targets <span class="token operator">=</span> soup<span class="token punctuation">.</span>find_all<span class="token punctuation">(</span><span class="token string">"span"</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">"rating_num"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="51"></td><td><pre>    <span class="token keyword">for</span> each <span class="token keyword">in</span> targets<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="52"></td><td><pre>        <span class="token keyword">try</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="53"></td><td><pre>            ranks<span class="token punctuation">.</span>append<span class="token punctuation">(</span>each<span class="token punctuation">.</span>text<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="54"></td><td><pre>        <span class="token keyword">finally</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="55"></td><td><pre>            <span class="token keyword">continue</span></pre></td></tr><tr><td data-num="56"></td><td><pre></pre></td></tr><tr><td data-num="57"></td><td><pre>    <span class="token comment"># 导演</span></pre></td></tr><tr><td data-num="58"></td><td><pre>    director <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="59"></td><td><pre>    targets <span class="token operator">=</span> soup<span class="token punctuation">.</span>find_all<span class="token punctuation">(</span><span class="token string">"div"</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">"bd"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="60"></td><td><pre>    <span class="token keyword">for</span> each <span class="token keyword">in</span> targets<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="61"></td><td><pre>        <span class="token keyword">try</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="62"></td><td><pre>            director<span class="token punctuation">.</span>append<span class="token punctuation">(</span>each<span class="token punctuation">.</span>p<span class="token punctuation">.</span>text<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\xa0\xa0\xa0'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>lstrip<span class="token punctuation">(</span><span class="token string">'导演: '</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="63"></td><td><pre>        <span class="token keyword">finally</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="64"></td><td><pre>            <span class="token keyword">continue</span></pre></td></tr><tr><td data-num="65"></td><td><pre></pre></td></tr><tr><td data-num="66"></td><td><pre>    <span class="token comment"># 主演</span></pre></td></tr><tr><td data-num="67"></td><td><pre>    leading_actor <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="68"></td><td><pre>    targets <span class="token operator">=</span> soup<span class="token punctuation">.</span>find_all<span class="token punctuation">(</span><span class="token string">"div"</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">"bd"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="69"></td><td><pre>    <span class="token keyword">for</span> each <span class="token keyword">in</span> targets<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="70"></td><td><pre>        <span class="token keyword">try</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="71"></td><td><pre>            leading_actor<span class="token punctuation">.</span>append<span class="token punctuation">(</span>each<span class="token punctuation">.</span>p<span class="token punctuation">.</span>text<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\xa0\xa0\xa0'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'主演:'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="72"></td><td><pre>        <span class="token keyword">finally</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="73"></td><td><pre>            <span class="token keyword">continue</span></pre></td></tr><tr><td data-num="74"></td><td><pre>    <span class="token keyword">if</span> movies<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"肖申克的救赎"</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="75"></td><td><pre>        leading_actor<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">,</span> <span class="token string">"无"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="76"></td><td><pre>    <span class="token keyword">if</span> movies<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"大闹天宫"</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="77"></td><td><pre>        leading_actor<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">"无"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="78"></td><td><pre>        leading_actor<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">"无"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="79"></td><td><pre>    <span class="token keyword">if</span> movies<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"美国往事"</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="80"></td><td><pre>        leading_actor<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">"无"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="81"></td><td><pre>    <span class="token keyword">if</span> movies<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"阳光姐妹淘"</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="82"></td><td><pre>        leading_actor<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">23</span><span class="token punctuation">,</span> <span class="token string">"无"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="83"></td><td><pre>    <span class="token keyword">if</span> movies<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"七武士"</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="84"></td><td><pre>        leading_actor<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">"无"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="85"></td><td><pre>    <span class="token keyword">if</span> movies<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"模仿游戏"</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="86"></td><td><pre>        leading_actor<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">"无"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="87"></td><td><pre>        leading_actor<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token string">"无"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="88"></td><td><pre>    <span class="token keyword">if</span> movies<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"罗生门"</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="89"></td><td><pre>        leading_actor<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">"无"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="90"></td><td><pre></pre></td></tr><tr><td data-num="91"></td><td><pre>    <span class="token comment"># 评价人数</span></pre></td></tr><tr><td data-num="92"></td><td><pre>    people <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="93"></td><td><pre>    targets <span class="token operator">=</span> soup<span class="token punctuation">.</span>find_all<span class="token punctuation">(</span><span class="token string">"div"</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">"star"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="94"></td><td><pre>    <span class="token keyword">for</span> each <span class="token keyword">in</span> targets<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="95"></td><td><pre>        <span class="token keyword">try</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="96"></td><td><pre>            people<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>each<span class="token punctuation">.</span>contents<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">.</span>rstrip<span class="token punctuation">(</span><span class="token string">"人评价"</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="97"></td><td><pre>        <span class="token keyword">finally</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="98"></td><td><pre>            <span class="token keyword">continue</span></pre></td></tr><tr><td data-num="99"></td><td><pre></pre></td></tr><tr><td data-num="100"></td><td><pre>    <span class="token comment"># 电影描述，最后两页分别有两篇电影没有描述</span></pre></td></tr><tr><td data-num="101"></td><td><pre>    sentence <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="102"></td><td><pre>    targets <span class="token operator">=</span> soup<span class="token punctuation">.</span>find_all<span class="token punctuation">(</span><span class="token string">"span"</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">"inq"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="103"></td><td><pre>    <span class="token keyword">for</span> each <span class="token keyword">in</span> targets<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="104"></td><td><pre>        <span class="token keyword">try</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="105"></td><td><pre>            sentence<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>each<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="106"></td><td><pre>        <span class="token keyword">finally</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="107"></td><td><pre>            <span class="token keyword">continue</span></pre></td></tr><tr><td data-num="108"></td><td><pre>    <span class="token keyword">if</span> sentence<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"天使保护事件始末。"</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="109"></td><td><pre>        sentence<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token string">"无"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="110"></td><td><pre>        sentence<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">,</span> <span class="token string">"无"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="111"></td><td><pre>    <span class="token keyword">if</span> sentence<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"生病的E.T.皮肤的颜色就像柿子饼。"</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="112"></td><td><pre>        sentence<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token string">"无"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="113"></td><td><pre>        sentence<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">22</span><span class="token punctuation">,</span> <span class="token string">"无"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="114"></td><td><pre></pre></td></tr><tr><td data-num="115"></td><td><pre>    <span class="token comment"># 年份</span></pre></td></tr><tr><td data-num="116"></td><td><pre>    year <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="117"></td><td><pre>    targets <span class="token operator">=</span> soup<span class="token punctuation">.</span>find_all<span class="token punctuation">(</span><span class="token string">"div"</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">"bd"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="118"></td><td><pre>    <span class="token keyword">for</span> each <span class="token keyword">in</span> targets<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="119"></td><td><pre>        <span class="token keyword">try</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="120"></td><td><pre>            year<span class="token punctuation">.</span>append<span class="token punctuation">(</span>each<span class="token punctuation">.</span>p<span class="token punctuation">.</span>text<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\xa0'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">"(中国大陆)"</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="121"></td><td><pre>        <span class="token keyword">finally</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="122"></td><td><pre>            <span class="token keyword">continue</span></pre></td></tr><tr><td data-num="123"></td><td><pre>    <span class="token keyword">if</span> movies<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"大闹天宫"</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="124"></td><td><pre>        year<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"1961 / 1964 / 1978 / 2004"</span></pre></td></tr><tr><td data-num="125"></td><td><pre>    <span class="token comment"># 国家</span></pre></td></tr><tr><td data-num="126"></td><td><pre>    country <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="127"></td><td><pre>    targets <span class="token operator">=</span> soup<span class="token punctuation">.</span>find_all<span class="token punctuation">(</span><span class="token string">"div"</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">"bd"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="128"></td><td><pre>    <span class="token keyword">for</span> each <span class="token keyword">in</span> targets<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="129"></td><td><pre>        <span class="token keyword">try</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="130"></td><td><pre>            country<span class="token punctuation">.</span>append<span class="token punctuation">(</span>each<span class="token punctuation">.</span>p<span class="token punctuation">.</span>text<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\xa0'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="131"></td><td><pre>        <span class="token keyword">finally</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="132"></td><td><pre>            <span class="token keyword">continue</span></pre></td></tr><tr><td data-num="133"></td><td><pre>    <span class="token comment"># 类型</span></pre></td></tr><tr><td data-num="134"></td><td><pre>    kinds <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="135"></td><td><pre>    targets <span class="token operator">=</span> soup<span class="token punctuation">.</span>find_all<span class="token punctuation">(</span><span class="token string">"div"</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">"bd"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="136"></td><td><pre>    <span class="token keyword">for</span> each <span class="token keyword">in</span> targets<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="137"></td><td><pre>        <span class="token keyword">try</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="138"></td><td><pre>            kinds<span class="token punctuation">.</span>append<span class="token punctuation">(</span>each<span class="token punctuation">.</span>p<span class="token punctuation">.</span>text<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\xa0'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="139"></td><td><pre>        <span class="token keyword">finally</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="140"></td><td><pre>            <span class="token keyword">continue</span></pre></td></tr><tr><td data-num="141"></td><td><pre>    result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="142"></td><td><pre>    length <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>movies<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="143"></td><td><pre>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>length<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="144"></td><td><pre>        result<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span>movies<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> ranks<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> director<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> leading_actor<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="145"></td><td><pre>                       people<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> sentence<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> year<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> country<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> kinds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="146"></td><td><pre>    <span class="token keyword">return</span> result</pre></td></tr><tr><td data-num="147"></td><td><pre></pre></td></tr><tr><td data-num="148"></td><td><pre></pre></td></tr><tr><td data-num="149"></td><td><pre><span class="token comment"># 找出一共有多少个页面</span></pre></td></tr><tr><td data-num="150"></td><td><pre><span class="token keyword">def</span> <span class="token function">find_pages</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="151"></td><td><pre>    soup <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>res<span class="token punctuation">.</span>text<span class="token punctuation">,</span> <span class="token string">'html.parser'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="152"></td><td><pre>    depth <span class="token operator">=</span> soup<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'span'</span><span class="token punctuation">,</span> class_<span class="token operator">=</span><span class="token string">'next'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>previous_sibling<span class="token punctuation">.</span>previous_sibling<span class="token punctuation">.</span>text</pre></td></tr><tr><td data-num="153"></td><td><pre></pre></td></tr><tr><td data-num="154"></td><td><pre>    <span class="token keyword">return</span> <span class="token builtin">int</span><span class="token punctuation">(</span>depth<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="155"></td><td><pre></pre></td></tr><tr><td data-num="156"></td><td><pre></pre></td></tr><tr><td data-num="157"></td><td><pre><span class="token keyword">def</span> <span class="token function">save_to_excel</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="158"></td><td><pre>    wb <span class="token operator">=</span> Workbook<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="159"></td><td><pre>    ws <span class="token operator">=</span> wb<span class="token punctuation">.</span>active</pre></td></tr><tr><td data-num="160"></td><td><pre>    ws<span class="token punctuation">[</span><span class="token string">"A1"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"名称"</span></pre></td></tr><tr><td data-num="161"></td><td><pre>    ws<span class="token punctuation">[</span><span class="token string">"B1"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"评分"</span></pre></td></tr><tr><td data-num="162"></td><td><pre>    ws<span class="token punctuation">[</span><span class="token string">"c1"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"导演"</span></pre></td></tr><tr><td data-num="163"></td><td><pre>    ws<span class="token punctuation">[</span><span class="token string">'d1'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"主演"</span></pre></td></tr><tr><td data-num="164"></td><td><pre>    ws<span class="token punctuation">[</span><span class="token string">"e1"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"评价人数"</span></pre></td></tr><tr><td data-num="165"></td><td><pre>    ws<span class="token punctuation">[</span><span class="token string">"f1"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"电影描述"</span></pre></td></tr><tr><td data-num="166"></td><td><pre>    ws<span class="token punctuation">[</span><span class="token string">"g1"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"年份"</span></pre></td></tr><tr><td data-num="167"></td><td><pre>    ws<span class="token punctuation">[</span><span class="token string">"h1"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"国家"</span></pre></td></tr><tr><td data-num="168"></td><td><pre>    ws<span class="token punctuation">[</span><span class="token string">"i1"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"类型"</span></pre></td></tr><tr><td data-num="169"></td><td><pre>    <span class="token keyword">for</span> each <span class="token keyword">in</span> result<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="170"></td><td><pre>        ws<span class="token punctuation">.</span>append<span class="token punctuation">(</span>each<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="171"></td><td><pre>    wb<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token string">"豆瓣电影TOP250.xlsx"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="172"></td><td><pre></pre></td></tr><tr><td data-num="173"></td><td><pre></pre></td></tr><tr><td data-num="174"></td><td><pre><span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="175"></td><td><pre>    host <span class="token operator">=</span> <span class="token string">"https://movie.douban.com/top250"</span></pre></td></tr><tr><td data-num="176"></td><td><pre>    res <span class="token operator">=</span> get_html<span class="token punctuation">(</span>host<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="177"></td><td><pre>    depth <span class="token operator">=</span> find_pages<span class="token punctuation">(</span>res<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="178"></td><td><pre>    result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="179"></td><td><pre>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>depth<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="180"></td><td><pre>        url <span class="token operator">=</span> host <span class="token operator">+</span> <span class="token string">'/?start='</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token number">25</span> <span class="token operator">*</span> i<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="181"></td><td><pre>        res <span class="token operator">=</span> get_html<span class="token punctuation">(</span>url<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="182"></td><td><pre>        result<span class="token punctuation">.</span>extend<span class="token punctuation">(</span>parser_html<span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="183"></td><td><pre>    save_to_excel<span class="token punctuation">(</span>result<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="184"></td><td><pre></pre></td></tr><tr><td data-num="185"></td><td><pre></pre></td></tr><tr><td data-num="186"></td><td><pre><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="187"></td><td><pre>    main<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h1 id="部分结果展示"><a class="anchor" href="#部分结果展示">#</a> 部分结果展示</h1><p><img data-src="/images/3.jpg" alt="我在这里"></p><div class="tags"><a href="/tags/%E7%88%AC%E8%99%AB/" rel="tag"><i class="ic i-tag"></i> 爬虫</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2020-12-16 19:39:59" itemprop="dateModified" datetime="2020-12-16T19:39:59+08:00">2020-12-16</time> </span><span id="python/crawler-case/爬取豆瓣TOP250/" class="item leancloud_visitors" data-flag-title="爬取豆瓣TOP250" title="阅读次数"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">阅读次数</span> <span class="leancloud-visitors-count"></span> <span class="text">次</span></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> 赞赏</button><p>请我喝[茶]~(￣▽￣)~*</p><div id="qr"><div><img data-src="/images/wechatpay.png" alt="阿冬 微信支付"><p>微信支付</p></div><div><img data-src="/images/alipay.png" alt="阿冬 支付宝"><p>支付宝</p></div><div><img data-src="/images/paypal.png" alt="阿冬 贝宝"><p>贝宝</p></div></div></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>阿冬 <i class="ic i-at"><em>@</em></i>你好，世界</li><li class="link"><strong>本文链接：</strong> <a href="https://github.com/ICAN1999/ICAN1999.github.io.git/python/crawler-case/%E7%88%AC%E5%8F%96%E8%B1%86%E7%93%A3TOP250/" title="爬取豆瓣TOP250">https://github.com/ICAN1999/ICAN1999.github.io.git/python/crawler-case/爬取豆瓣TOP250/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"></div><div class="item right"><a href="/python/crawler-case/%E7%88%AC%E5%8F%96%E6%9C%89%E9%81%93%E7%BF%BB%E8%AF%91/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;s3.ax1x.com&#x2F;2020&#x2F;12&#x2F;17&#x2F;rG1Hv4.jpg" title="爬取有道翻译"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> 爬虫案例</span><h3>爬取有道翻译</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C"><span class="toc-number">1.</span> <span class="toc-text">准备工作</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%82%E5%AF%9F"><span class="toc-number">1.1.</span> <span class="toc-text">观察</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%9D%E8%AF%95%E8%8E%B7%E5%8F%96%E9%A1%B5%E9%9D%A2%E6%BA%90%E4%BB%A3%E7%A0%81"><span class="toc-number">1.2.</span> <span class="toc-text">尝试获取页面源代码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%B7%E6%B1%82%E6%A0%87%E5%A4%B4"><span class="toc-number">1.3.</span> <span class="toc-text">请求标头</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%A3%E7%90%86-ip"><span class="toc-number">1.4.</span> <span class="toc-text">代理 ip</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#cookie-%E8%AE%A4%E8%AF%81"><span class="toc-number">1.5.</span> <span class="toc-text">cookie 认证</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E5%BE%97%E5%88%B0-10-%E8%BF%99%E4%B8%AA%E6%95%B0%E5%AD%97"><span class="toc-number">1.6.</span> <span class="toc-text">如何得到 10 这个数字</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%88%AC%E5%8F%96%E7%BD%91%E9%A1%B5"><span class="toc-number">2.</span> <span class="toc-text">爬取网页</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%A7%A3%E6%9E%90%E7%BD%91%E9%A1%B5"><span class="toc-number">3.</span> <span class="toc-text">解析网页</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%B5%E5%BD%B1%E5%90%8D"><span class="toc-number">3.1.</span> <span class="toc-text">电影名</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%84%E5%88%86"><span class="toc-number">3.2.</span> <span class="toc-text">评分</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%BC%E6%BC%94"><span class="toc-number">3.3.</span> <span class="toc-text">导演</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BB%E6%BC%94"><span class="toc-number">3.4.</span> <span class="toc-text">主演</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%84%E4%BB%B7%E4%BA%BA%E6%95%B0"><span class="toc-number">3.5.</span> <span class="toc-text">评价人数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%B5%E5%BD%B1%E6%8F%8F%E8%BF%B0"><span class="toc-number">3.6.</span> <span class="toc-text">电影描述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8A%E6%98%A0%E6%97%B6%E9%97%B4"><span class="toc-number">3.7.</span> <span class="toc-text">上映时间</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%BD%E5%AE%B6"><span class="toc-number">3.8.</span> <span class="toc-text">国家</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B1%BB%E5%9E%8B"><span class="toc-number">3.9.</span> <span class="toc-text">类型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B4%E5%90%88%E6%95%B0%E6%8D%AE"><span class="toc-number">3.10.</span> <span class="toc-text">整合数据</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BF%9D%E5%AD%98%E6%95%B0%E6%8D%AE"><span class="toc-number">4.</span> <span class="toc-text">保存数据</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%BB%E5%87%BD%E6%95%B0"><span class="toc-number">5.</span> <span class="toc-text">主函数</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%A8%8B%E5%BA%8F%E4%BB%A3%E7%A0%81"><span class="toc-number">6.</span> <span class="toc-text">程序代码</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%83%A8%E5%88%86%E7%BB%93%E6%9E%9C%E5%B1%95%E7%A4%BA"><span class="toc-number">7.</span> <span class="toc-text">部分结果展示</span></a></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li class="active"><a href="/python/crawler-case/%E7%88%AC%E5%8F%96%E8%B1%86%E7%93%A3TOP250/" rel="bookmark" title="爬取豆瓣TOP250">爬取豆瓣TOP250</a></li><li><a href="/python/crawler-case/%E7%88%AC%E5%8F%96%E6%9C%89%E9%81%93%E7%BF%BB%E8%AF%91/" rel="bookmark" title="爬取有道翻译">爬取有道翻译</a></li><li><a href="/python/crawler-case/%E4%B8%AD%E5%9B%BD%E5%A4%A7%E5%AD%A6%E6%8E%92%E5%90%8D%E7%88%AC%E5%8F%96/" rel="bookmark" title="中国大学排名爬取">中国大学排名爬取</a></li><li><a href="/python/crawler-case/%E6%B7%98%E5%AE%9D%E5%95%86%E5%93%81%E6%AF%94%E4%BB%B7%E5%AE%9A%E5%90%91%E7%88%AC%E8%99%AB/" rel="bookmark" title="淘宝商品比价定向爬虫">淘宝商品比价定向爬虫</a></li><li><a href="/%E7%BD%91%E7%BB%9C%E7%88%AC%E8%99%AB%E7%9A%84%E7%9A%84%E2%80%9C%E2%80%9C%E7%9B%97%E4%BA%A6%E6%9C%89%E9%81%93%E2%80%9D/" rel="bookmark" title="网络爬虫的的“盗亦有道”">网络爬虫的的“盗亦有道”</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="阿冬" data-src="/images/%E6%9C%AA%E6%9D%A5.jpg"><p class="name" itemprop="name">阿冬</p><div class="description" itemprop="description">想进大厂的小白</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">11</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">7</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">7</span> <span class="name">标签</span></a></div></nav><div class="social"><a href="https://github.com/ICAN1999" title="https:&#x2F;&#x2F;github.com&#x2F;ICAN1999" class="item github"><i class="ic i-github"></i></a> <span class="exturl item music" data-url="aHR0cHM6Ly9tdXNpYy4xNjMuY29tLyMvdXNlci9ob21lP2lkPTIwNTQ4Mzc5NTA=" title="https:&#x2F;&#x2F;music.163.com&#x2F;#&#x2F;user&#x2F;home?id&#x3D;2054837950"><i class="ic i-cloud-music"></i></span> <span class="exturl item bilibili" data-url="aHR0cHM6Ly9zcGFjZS5iaWxpYmlsaS5jb20vNTA1NzE1NTEx" title="https:&#x2F;&#x2F;space.bilibili.com&#x2F;505715511"><i class="ic i-youtube"></i></span> <span class="exturl item email" data-url="bWFpbHRvOjE2MzIxNjc4MTNAcXEuY29t" title="mailto:1632167813@qq.com"><i class="ic i-envelope"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>关于</a></li><li class="item"><a href="/links/" rel="section"><i class="ic i-magic"></i>友链</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/python/" title="分类于 Python">Python</a> <i class="ic i-angle-right"></i> <a href="/categories/python/crawler-case/" title="分类于 爬虫案例">爬虫案例</a></div><span><a href="/%E7%BD%91%E7%BB%9C%E7%88%AC%E8%99%AB%E7%9A%84%E7%9A%84%E2%80%9C%E2%80%9C%E7%9B%97%E4%BA%A6%E6%9C%89%E9%81%93%E2%80%9D/" title="网络爬虫的的“盗亦有道”">网络爬虫的的“盗亦有道”</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/python/" title="分类于 Python">Python</a> <i class="ic i-angle-right"></i> <a href="/categories/python/crawler-case/" title="分类于 爬虫案例">爬虫案例</a></div><span><a href="/python/crawler-case/%E4%B8%AD%E5%9B%BD%E5%A4%A7%E5%AD%A6%E6%8E%92%E5%90%8D%E7%88%AC%E5%8F%96/" title="中国大学排名爬取">中国大学排名爬取</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/python/" title="分类于 Python">Python</a> <i class="ic i-angle-right"></i> <a href="/categories/python/crawler-case/" title="分类于 爬虫案例">爬虫案例</a></div><span><a href="/python/crawler-case/%E7%88%AC%E5%8F%96%E8%B1%86%E7%93%A3TOP250/" title="爬取豆瓣TOP250">爬取豆瓣TOP250</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/" title="正则表达式">正则表达式</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/python/" title="分类于 Python">Python</a> <i class="ic i-angle-right"></i> <a href="/categories/python/%E7%BB%8F%E5%85%B8%E6%A1%88%E4%BE%8B/" title="分类于 经典案例">经典案例</a></div><span><a href="/%E5%AD%A6%E7%94%9F%E6%88%90%E7%BB%A9%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/" title="学生成绩管理系统">学生成绩管理系统</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/python/" title="分类于 Python">Python</a> <i class="ic i-angle-right"></i> <a href="/categories/python/crawler-case/" title="分类于 爬虫案例">爬虫案例</a></div><span><a href="/python/crawler-case/%E7%88%AC%E5%8F%96%E6%9C%89%E9%81%93%E7%BF%BB%E8%AF%91/" title="爬取有道翻译">爬取有道翻译</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/data-structure/" title="分类于 数据结构">数据结构</a> <i class="ic i-angle-right"></i> <a href="/categories/data-structure/C-%E5%8E%8B%E7%BC%A9%E8%BD%AF%E4%BB%B6/" title="分类于 C++压缩软件">C++压缩软件</a></div><span><a href="/data-structure/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1/" title="C++压缩软件">C++压缩软件</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/python/" title="分类于 Python">Python</a> <i class="ic i-angle-right"></i> <a href="/categories/python/Requests/" title="分类于 Requests">Requests</a></div><span><a href="/Requests%E5%BA%93%E5%85%A5%E9%97%A8/" title="Requests库入门">Requests库入门</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/%E5%BB%BA%E7%AB%99%E6%97%A5%E5%BF%97/" title="建站日志">建站日志</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/python/" title="分类于 Python">Python</a> <i class="ic i-angle-right"></i> <a href="/categories/python/BeautifulSoup/" title="分类于 BeautifulSoup">BeautifulSoup</a></div><span><a href="/BeautifulSoup%E5%BA%93%E5%85%A5%E9%97%A8/" title="BeautifulSoup库入门">BeautifulSoup库入门</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2019 – <span itemprop="copyrightYear">2020</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">阿冬 @ Hello World</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">39k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">36 分钟</span></div><div class="powered-by">Hello, welcome to my blog.</div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"python/crawler-case/爬取豆瓣TOP250/",favicon:{show:"（●´3｀●）やれやれだぜ",hide:"(´Д｀)大変だ！"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html><!-- rebuild by hrmmi -->